(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90],{2602:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{default:function(){return i},noSSR:function(){return n}});let a=l(8754);l(5893),l(7294);let r=a._(l(5491));function s(e){return{default:(null==e?void 0:e.default)||e}}function n(e,t){return delete t.webpack,delete t.modules,e(t)}function i(e,t){let l=r.default,a={loading:e=>{let{error:t,isLoading:l,pastDelay:a}=e;return null}};e instanceof Promise?a.loader=()=>e:"function"==typeof e?a.loader=e:"object"==typeof e&&(a={...a,...e});let i=(a={...a,...t}).loader;return(a.loadableGenerated&&(a={...a,...a.loadableGenerated},delete a.loadableGenerated),"boolean"!=typeof a.ssr||a.ssr)?l({...a,loader:()=>null!=i?i().then(s):Promise.resolve(s(()=>null))}):(delete a.webpack,delete a.modules,n(l,a))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1159:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return a}});let a=l(8754)._(l(7294)).default.createContext(null)},5491:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return m}});let a=l(8754)._(l(7294)),r=l(1159),s=[],n=[],i=!1;function o(e){let t=e(),l={loading:!0,loaded:null,error:null};return l.promise=t.then(e=>(l.loading=!1,l.loaded=e,e)).catch(e=>{throw l.loading=!1,l.error=e,e}),l}class d{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function c(e){return function(e,t){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),s=null;function o(){if(!s){let t=new d(e,l);s={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return s.promise()}if(!i){let e=l.webpack?l.webpack():l.modules;e&&n.push(t=>{for(let l of e)if(t.includes(l))return o()})}function c(e,t){!function(){o();let e=a.default.useContext(r.LoadableContext);e&&Array.isArray(l.modules)&&l.modules.forEach(t=>{e(t)})}();let n=a.default.useSyncExternalStore(s.subscribe,s.getCurrentValue,s.getCurrentValue);return a.default.useImperativeHandle(t,()=>({retry:s.retry}),[]),a.default.useMemo(()=>{var t;return n.loading||n.error?a.default.createElement(l.loading,{isLoading:n.loading,pastDelay:n.pastDelay,timedOut:n.timedOut,error:n.error,retry:s.retry}):n.loaded?a.default.createElement((t=n.loaded)&&t.default?t.default:t,e):null},[e,n])}return c.preload=()=>o(),c.displayName="LoadableComponent",a.default.forwardRef(c)}(o,e)}function u(e,t){let l=[];for(;e.length;){let a=e.pop();l.push(a(t))}return Promise.all(l).then(()=>{if(e.length)return u(e,t)})}c.preloadAll=()=>new Promise((e,t)=>{u(s).then(e,t)}),c.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let l=()=>(i=!0,t());u(n,e).then(l,l)})),window.__NEXT_PRELOADREADY=c.preloadReady;let m=c},2945:function(e,t,l){"use strict";var a=l(5893),r=l(1163),s=l(7294),n=l(4273),i=l(4447),o=l(6135);t.Z=e=>t=>{let l=(0,r.useRouter)(),{user:d,loading:c}=(0,n.Z)(),u=(0,i.j)();return((0,s.useEffect)(()=>{c||d&&"admin"===u||l.push("/sign-in")},[d,c,u,l]),c||!d||"admin"!==u)?(0,a.jsx)(o.a,{}):(0,a.jsx)(e,{...t})}},1670:function(e,t,l){"use strict";l.d(t,{W:function(){return r}});var a=l(5893);l(7294);let r=e=>{let{type:t,placeholder:l,value:r,name:s,onChange:n}=e;return(0,a.jsx)("input",{type:t,placeholder:l,value:r,name:s,onChange:n,className:"max-w-96 border border-gray-300 rounded-md"})}},6135:function(e,t,l){"use strict";l.d(t,{a:function(){return r}});var a=l(5893);l(7294);let r=()=>(0,a.jsx)("div",{className:"lg:mx-16 md:mx-12 mx-8 my-8 fade-in",children:(0,a.jsx)("div",{className:"flex justify-center h-screen",children:(0,a.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-row w-full items-center gap-4",children:[(0,a.jsx)("div",{className:"skeleton h-72 w-72 shrink-0 rounded-2xl"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 flex-grow",children:[(0,a.jsx)("span",{className:"loading loading-ring loading-lg"}),(0,a.jsx)("div",{className:"skeleton h-4 w-full"}),(0,a.jsx)("div",{className:"skeleton h-4 w-full"})]})]}),(0,a.jsx)("div",{className:"skeleton h-96 w-full"})]})})})},2556:function(e,t,l){"use strict";l.d(t,{u:function(){return r}});var a=l(5893);l(7294);let r=e=>{let{variations:t,heading:l,currentVariation:r,setCurrentVariation:s}=e;if(0===t.length)return null;let n={red:"bg-red-400 text-white",blue:"bg-blue-400 text-white",green:"bg-green-400 text-white",yellow:"bg-yellow-400 text-black",purple:"bg-purple-400 text-white",white:"bg-white text-black text-black",black:"bg-black text-white"},i=e=>n[e.toLowerCase()]||"bg-gray-400";return(0,a.jsxs)("div",{className:"flex flex-col mt-5",children:[(0,a.jsxs)("p",{className:"font-semibold my-4 ml-1 text-lg ",children:["Select ",l,":"]}),(0,a.jsx)("div",{className:"variations flex flex-row flex-wrap justify-start capitalize font-medium ",children:t.map(e=>(0,a.jsx)("div",{onClick:()=>s(e),className:`px-6 py-4 m-2 w-auto text-base-content  ${i(e)} rounded-lg cursor-pointer shadow-md duration-200 hover:-translate-y-1 hover:opacity-80
            ${e===r?"outline-3 outline-base-content":" outline-1 outline-base-300"}  outline  `,children:e},e))})]})}},9312:function(e,t,l){"use strict";l.d(t,{Z:function(){return b}});var a=l(5893),r=l(7294),s=l(1095),n=l(6528),i=l(109),o=l(6650),d=e=>{let{heading:t,attributes:l,selectedAttributes:r=[],setSelectedAttributes:s}=e,n=e=>e.toLowerCase(),i=e=>{let t=n(e);s(l=>l.map(n).includes(t)?l.filter(e=>n(e)!==t):[...l,e])};return(0,a.jsxs)("div",{className:"attributes-selector max-w-md",children:[(0,a.jsx)("h3",{children:t}),(0,a.jsx)("div",{className:"flex flex-row flex-wrap",children:l.map(e=>(0,a.jsxs)("label",{htmlFor:e,className:"block mb-2 border border-base m-2 p-2",children:[(0,a.jsx)("input",{type:"checkbox",id:e,checked:r.map(n).includes(n(e)),onChange:()=>i(e),className:"mr-2"}),e]},e))}),(0,a.jsx)("button",{onClick:()=>s([]),children:"Clear All"})]})},c=l(1670);l(6834);var u=l(5152);let m=l.n(u)()(()=>Promise.all([l.e(937),l.e(167)]).then(l.t.bind(l,1167,23)),{loadableGenerated:{webpack:()=>[1167]},ssr:!1}),f=e=>{let{productInfo:t,setProductInfo:l}=e,r=e=>{let{name:t,value:a}=e.target;l(e=>({...e,[t]:a}))};return(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(c.W,{type:"text",placeholder:"Name",value:t.name,onChange:r,name:"name"}),(0,a.jsxs)("div",{className:"flex flex-col ",children:[(0,a.jsx)("label",{className:"ml-2 mt-4 font-semibold",children:"Description: "}),(0,a.jsx)(m,{value:t.description,onChange:e=>{l(t=>({...t,description:e}))},className:"mb-4"})]}),(0,a.jsx)(c.W,{type:"text",placeholder:"SKU",value:t.sku,onChange:r,name:"sku"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"ml-2 mt-4 font-semibold",children:"Full Price: "}),(0,a.jsx)(c.W,{type:"number",placeholder:"Full Price",value:t.full_price,onChange:r,name:"full_price"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"ml-2 mt-4 font-semibold",children:"Sale Price: "}),(0,a.jsx)(c.W,{type:"number",placeholder:"Sale Price",value:t.sale_price??0,onChange:r,name:"sale_price"})]})]})};var p=l(3250),h=l(1664),x=l.n(h),g=l(2556),b=e=>{let{product:t}=e,[l,c]=(0,r.useState)(p.u5),[u,m]=(0,r.useState)(""),[h,b]=(0,r.useState)([]),[_,y]=(0,r.useState)([]),[j,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{t&&(console.log("Loading existing product:",t),c(t),m(t.category),b(t.tags),y(t.variations))},[t]);let v=async()=>{let e=[...l.images],a=(0,o.cF)(),r=(e,t)=>new Promise((l,a)=>{let r=document.createElement("img");r.src=URL.createObjectURL(e),r.onload=()=>{let s=r.width/r.height,n=document.createElement("canvas");n.height=t,n.width=t*s;let i=n.getContext("2d");i?.drawImage(r,0,0,n.width,n.height),n.toBlob(e=>{e?l(e):a(Error("Canvas is empty"))},e.type)},r.onerror=e=>{a(e)}});if(j)for(let t=0;t<j.length;t++){let s=j[t],n=`${Date.now()}-${l.name}-${t+1}`,i=(0,o.iH)(a,`product-images/${n}`),d=await r(s,500);await (0,o.KV)(i,d);let c=await (0,o.Jt)(i);e.push(c)}let s=(0,i.ad)();try{if(t){let a=(0,i.JU)(s,"products",t.id);await (0,i.r7)(a,{...l,name:l.name,description:l.description,full_price:l.full_price,sale_price:l.sale_price,images:e,variations:_,category:u,tags:h,updated_at:new Date}),alert("Product updated successfully!")}else{let t=await (0,i.ET)((0,i.hJ)(s,"products"),{...l,full_price:void 0!==l.full_price?l.full_price-.01:null,sale_price:void 0!==l.sale_price?l.sale_price-.03:null,images:e,variations:_,category:u,tags:h,created_at:new Date,updated_at:new Date,sold_to_date:0,stock:10});await (0,i.r7)((0,i.JU)(s,"products",t.id),{id:t.id}),alert("Product created successfully!"),c(p.u5),m(""),b([]),y([]),w(null)}}catch(e){console.error("Error saving product:",e)}},N=async e=>{let t=parseInt(e.currentTarget.dataset.index||"0",10),a=l.images[t];if(!a){console.error("Image URL not found");return}let r=decodeURIComponent(a.split("/").pop()?.split("?")[0]||"");if(!r){console.error("Invalid image name");return}let s=(0,o.cF)(),n=(0,o.iH)(s,`${r}`);console.log(r);try{await (0,o.oq)(n);let e=l.images.filter((e,l)=>l!==t),a=(0,i.ad)(),r=(0,i.JU)(a,"products",l.id);await (0,i.r7)(r,{images:e}),c(t=>({...t,images:e}))}catch(e){console.error("Error deleting image:",e)}};return(0,a.jsxs)("div",{className:"flex flex-col max-w-7xl mx-auto my-6",children:[(0,a.jsx)("h1",{children:t?"Edit Product":"Create New Product"}),t&&(0,a.jsxs)("div",{className:"flex flex-row flex-wrap",children:[(0,a.jsx)(x(),{href:"/admin/create-product",children:(0,a.jsx)("p",{className:"m-4 text-xl ",children:" + Create New Product"})}),(0,a.jsx)(x(),{href:`/product/${t.id}`,children:(0,a.jsx)("p",{className:"m-4 text-xl ",children:" → View Product"})})]}),(0,a.jsx)(x(),{href:"/admin/all-products",children:(0,a.jsx)("p",{className:"m-4 text-xl ",children:" ← Back to All Products"})}),(0,a.jsxs)("div",{className:"create-product-information flex flex-col",children:[l.images.length>0&&(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"ml-2 mt-4 font-semibold",children:"Current Images: "}),(0,a.jsx)("div",{className:"flex flex-row",children:l.images.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("button",{"data-index":t,onClick:N,className:"text-red-500",children:"x"}),(0,a.jsx)("img",{src:e,alt:l.name,width:"100",className:"m-2"})]},t))})]}),(0,a.jsx)(f,{productInfo:l,setProductInfo:c}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"ml-2 mt-4 font-semibold",children:"Images: "}),(0,a.jsx)("input",{type:"file",multiple:!0,onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);w(e=>{let l=e?Array.from(e).concat(t):t,a=new DataTransfer;return l.forEach(e=>a.items.add(e)),a.files})}},className:"max-w-96 border border-gray-300 rounded-md mb-2 p-2"})]}),(0,a.jsx)(d,{attributes:p.x7,heading:"Variations",selectedAttributes:_,setSelectedAttributes:y}),(0,a.jsx)(g.u,{variations:p.ZH,heading:"Category",currentVariation:u,setCurrentVariation:m}),(0,a.jsx)(d,{attributes:p.SW,heading:"Tags",selectedAttributes:h,setSelectedAttributes:b}),(0,a.jsx)(s.bH,{label:t?"Update Product":"Create Product",onClick:v,icon:n.pW})]})]})}},3250:function(e,t,l){"use strict";l.d(t,{SW:function(){return i},VM:function(){return r},ZH:function(){return n},u5:function(){return a},x7:function(){return s}});let a={id:"",name:"",description:"",full_price:0,sale_price:0,images:[],variations:[],category:"",tags:[],reviews:[],created_at:new Date,updated_at:new Date,sold_to_date:0,stock:0,sku:""},r={name:"",address_1:"",address_2:"",city:"",state:"",zip:"",country:"",email:"",phone:""},s=["Red","Blue","Green","Yellow","Purple","Pink","Black","White"],n=["paper","tools","kits"],i=["supplies","scissors","glue","tape","knives and blades","animals","masks","models","pens","markers","staples"]},6834:function(){},5152:function(e,t,l){e.exports=l(2602)}}]);