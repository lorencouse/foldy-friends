(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{682:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return l(2891)}])},2891:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return g}});var i=l(5893),a=l(7294),n=l(1163),r=l(4273),t=l(7385),c=l(4019),o=l(109),d=l(1095),f=l(1937),x=l(6528),u=l(6135);let m=e=>{let{shippingInfo:s,setShippingInfo:l,billingInfo:n,setBillingInfo:m,setEditProfile:p}=e,[h,j]=(0,a.useState)(!1),{user:g,loading:w}=(0,r.Z)(),N=async()=>{let e=c.I.currentUser;if(e)try{let l=(0,o.JU)(c.db,"users",e.uid),i={id:e.uid,created_at:new Date,shipping_info:s,billing_info:n,photo_url:e.photoURL||"",order_history:[]};await (0,o.pl)(l,i,{merge:!0}),e.email&&await (0,t.s)(e,e.email),(e.displayName||e.photoURL)&&await (0,t.ck)(e,{displayName:e.displayName,photoURL:e.photoURL}),p(!1),console.log("Profile updated successfully")}catch(e){console.error("Error updating profile: ",e)}};return w?(0,i.jsx)(u.a,{}):(0,i.jsxs)("div",{className:"flex flex-row flex-wrap md:grid md:grid-cols-2 justify-around",children:[(0,i.jsxs)("div",{className:"shipping-info flex flex-col",children:[(0,i.jsx)("div",{className:"flex flex-col"}),(0,i.jsx)("h2",{className:"text-left",children:"Shipping Info"}),(0,i.jsx)(f.I,{addressInfo:s,setAddressInfo:l}),(0,i.jsxs)("p",{children:["Email: ",g?.email||""]}),(0,i.jsxs)("div",{className:"flex",onClick:()=>j(!h),children:[(0,i.jsx)("input",{type:"checkbox",className:"checkbox",checked:h,readOnly:!0}),(0,i.jsx)("label",{className:"label cursor-pointer",children:"Edit Billing Info"})]}),!h&&(0,i.jsxs)("div",{className:"flex flex-row gap-4 m-auto",children:[(0,i.jsx)(d.bH,{label:"Update",icon:x.$U,onClick:N}),(0,i.jsx)(d.bH,{label:"Cancel",icon:x.BO,onClick:()=>p(!1)})]})]}),h&&(0,i.jsxs)("div",{className:"billing-info flex flex-col justify-around",children:[(0,i.jsx)("h2",{className:"text-left",children:"Billing Info"}),(0,i.jsx)(f.I,{addressInfo:n,setAddressInfo:m}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row flex-wrap gap-4 m-auto",children:[(0,i.jsx)(d.bH,{label:"Update",icon:x.$U,onClick:N}),(0,i.jsx)(d.bH,{label:"Cancel",icon:x.BO,onClick:()=>p(!1)})]})]})]})},p=e=>{let{shippingInfo:s,billingInfo:l}=e,{user:a}=(0,r.Z)(),n=["name","address_1","address_2","city","state","zip","country"];return(0,i.jsx)("div",{children:a&&(0,i.jsxs)("div",{className:"flex flex-row flex-wrap md:grid md:grid-cols-3 justify-around gap-20",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-7",children:[(0,i.jsxs)("p",{children:["Welcome back ",s.name]}),(0,i.jsx)("img",{src:"/assets/profile-photo.jpg",alt:"user profile avatar",className:"rounded-full max-h-32 max-w-32"})]}),(0,i.jsxs)("div",{className:"shipping-info flex flex-col",children:[(0,i.jsx)("h3",{children:"Shipping Info"}),n.map(e=>(0,i.jsxs)("div",{className:"flex flex-col capitalize my-4",children:[(0,i.jsx)("p",{className:"font-semibold",children:`${e.replace("_"," ")}: `}),(0,i.jsx)("p",{className:"",children:s[e]})]},e)),(0,i.jsxs)("p",{children:["Email: ",a.email]})]}),(0,i.jsx)("div",{className:"billing-info flex flex-col justify-around",children:""!==l.name&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"Billing Info"}),n.map(e=>(0,i.jsxs)("div",{className:"flex flex-col capitalize",children:[(0,i.jsx)("p",{className:"font-semibold",children:`${e.replace("_"," ")}:`}),(0,i.jsx)("p",{children:l[e]})]},e))]})})]})})};var h=l(3250),j=()=>{let{user:e,loading:s}=(0,r.Z)(),l=(0,n.useRouter)(),[f,j]=(0,a.useState)(""),[g,w]=(0,a.useState)(!1),[N,b]=(0,a.useState)(h.VM),[v,y]=(0,a.useState)(h.VM);if((0,a.useEffect)(()=>{let s=async()=>{if(e){let s=(0,o.JU)(c.db,"users",e.id),l=await (0,o.QT)(s);if(l.exists()){let e=l.data();console.log(e),b(e.shipping_info||N),y(e.billing_info||v)}else{let e={email:c.I.currentUser?.email,shipping_info:N,billing_info:v};await (0,o.pl)(s,e)}}};e&&s()},[e]),(0,a.useEffect)(()=>{s||e||l.push("/sign-in")},[e,s,l]),s)return(0,i.jsx)(u.a,{});let _=async()=>{try{await (0,t.w7)(c.I),l.push("/sign-in")}catch(e){console.error("Error signing out: ",e)}},k=async()=>{if(!window.confirm("Are you sure you want to delete your account? This action cannot be undone."))return;let e=c.I.currentUser;if(e)try{let s=t.w9.credential(e.email,prompt("Please enter your password to confirm"));await (0,t.aF)(e,s);let i=(0,o.JU)(c.db,"users",e.uid);await (0,o.oe)(i),await (0,t.h8)(e),l.push("/sign-in")}catch(e){j(e.message)}};return(0,i.jsx)("div",{className:"profile-page bg-base-100 min-h-screen flex justify-start",children:(0,i.jsxs)("div",{className:"user-profile max-w-7xl md:mx-20 mx-5 my-10",children:[(0,i.jsx)("h1",{children:"Account"}),g?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(m,{billingInfo:v,setBillingInfo:y,setShippingInfo:b,shippingInfo:N,setEditProfile:w})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p,{shippingInfo:N,billingInfo:v}),(0,i.jsx)(d.bH,{label:"Edit Profile",icon:x.V3,onClick:()=>w(!g)})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-4 justify-between mx-4",children:[(0,i.jsx)(d.bH,{label:"Sign Out",icon:x.fJ,onClick:_}),(0,i.jsx)(d.bH,{label:"Delete",icon:x.Tm,onClick:k})]})]})})},g=()=>(0,i.jsx)(j,{})},1937:function(e,s,l){"use strict";l.d(s,{I:function(){return r}});var i=l(5893);l(7294);var a=l(1670);let n=["name","address_1","address_2","city","state","zip","country","email","phone"],r=e=>{let{addressInfo:s,setAddressInfo:l}=e,r=e=>{let{name:s,value:i}=e.target;l(e=>({...e,[s]:i}))},t=e=>"email"===e?"email":"phone"===e?"tel":"text";return(0,i.jsx)("div",{children:n.map(e=>(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("label",{className:"ml-2 mt-4 font-semibold",htmlFor:`shipping_${e}`,children:[e.replace("_"," "),":"]}),(0,i.jsx)(a.W,{type:t(e),placeholder:e.replace("_"," "),value:s[e]||"",name:e,onChange:r})]},e))})}},1670:function(e,s,l){"use strict";l.d(s,{W:function(){return a}});var i=l(5893);l(7294);let a=e=>{let{type:s,placeholder:l,value:a,name:n,onChange:r}=e;return(0,i.jsx)("input",{type:s,placeholder:l,value:a,name:n,onChange:r,className:"max-w-96 border border-gray-300 rounded-md"})}},6135:function(e,s,l){"use strict";l.d(s,{a:function(){return a}});var i=l(5893);l(7294);let a=()=>(0,i.jsx)("div",{className:"lg:mx-16 md:mx-12 mx-8 my-8 fade-in",children:(0,i.jsx)("div",{className:"flex justify-center h-screen",children:(0,i.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row w-full items-center gap-4",children:[(0,i.jsx)("div",{className:"skeleton h-72 w-72 shrink-0 rounded-2xl"}),(0,i.jsxs)("div",{className:"flex flex-col gap-4 flex-grow",children:[(0,i.jsx)("span",{className:"loading loading-ring loading-lg"}),(0,i.jsx)("div",{className:"skeleton h-4 w-full"}),(0,i.jsx)("div",{className:"skeleton h-4 w-full"})]})]}),(0,i.jsx)("div",{className:"skeleton h-96 w-full"})]})})})},3250:function(e,s,l){"use strict";l.d(s,{SW:function(){return t},VM:function(){return a},ZH:function(){return r},u5:function(){return i},x7:function(){return n}});let i={id:"",name:"",description:"",full_price:0,sale_price:0,images:[],variations:[],category:"",tags:[],reviews:[],created_at:new Date,updated_at:new Date,sold_to_date:0,stock:0,sku:""},a={name:"",address_1:"",address_2:"",city:"",state:"",zip:"",country:"",email:"",phone:""},n=["Red","Blue","Green","Yellow","Purple","Pink","Black","White"],r=["paper","tools","kits"],t=["supplies","scissors","glue","tape","knives and blades","animals","masks","models","pens","markers","staples"]}},function(e){e.O(0,[888,774,179],function(){return e(e.s=682)}),_N_E=e.O()}]);